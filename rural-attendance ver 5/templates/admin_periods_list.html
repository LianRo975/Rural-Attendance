{% extends "base.html" %}
{% block content %}
<section class="card">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
    <div style="display:flex;gap:8px;align-items:center">
      <h2 style="margin:0">Periods</h2>
      <form method="get" action="{{ url_for('admin_periods_list') }}">
        <label for="school_id" style="font-size:14px;color:var(--muted)">School:</label>
        <select name="school_id" id="school_id" onchange="this.form.submit()"
                style="padding:8px 10px;border:1px solid var(--border);border-radius:8px;background:#fff">
          {% for s in schools %}
            <option value="{{ s.id }}" {% if selected_school_id==s.id %}selected{% endif %}>{{ s.name }}</option>
          {% endfor %}
        </select>
      </form>
    </div>
    <a class="btn btn-primary" href="{{ url_for('admin_periods_new') }}">Add Period</a>
  </div>

  {% if periods %}
    <table style="width:100%;border-collapse:collapse;margin-top:12px">
      <thead>
        <tr style="text-align:left;border-bottom:1px solid var(--border)">
          <th style="padding:10px">Order</th>
          <th style="padding:10px">Name</th>
          <th style="padding:10px">Start</th>
          <th style="padding:10px">End</th>
          <th style="padding:10px">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for p in periods %}
        <tr style="border-bottom:1px solid var(--border)">
          <td style="padding:10px">{{ p.sort_order }}</td>
          <td style="padding:10px">{{ p.name }}</td>
          <td style="padding:10px">{{ p.start_time or '—' }}</td>
          <td style="padding:10px">{{ p.end_time or '—' }}</td>
          <td style="padding:10px;white-space:nowrap">
            <a class="btn btn-ghost" href="{{ url_for('admin_periods_edit', period_id=p.id) }}">Edit</a>
            <form method="post" action="{{ url_for('admin_periods_delete', period_id=p.id) }}"
                  style="display:inline" onsubmit="return confirm('Delete this period?');">
              <button class="btn btn-ghost" type="submit">Delete</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p style="margin-top:12px;color:var(--muted)">No periods found for this school.</p>
  {% endif %}
</section>
{% endblock %}
